@model IEnumerable<ProjectFood.Models.Offer>

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    ViewBag.Title = "OfferIMPORT";
}

<div class="page-header">

   
        @if (Model.ToList().Count == 0)
        {
            @Html.ActionLink("PANIC AT THE DISCO", "ImportOffers", null, new { @class = "btn btn-danger btn-block" })
        }
        else
        {
            <h1>Tilbud</h1> 
            @Html.ActionLink("Hent tilbud fra API igen", "ImportOffers", null, new { @class = "btn btn-default btn-xs" })
        }
   

</div>


<ul class="nav nav-tabs">
    <li class="active"><a href="#all" data-toggle="tab">Alle tilbud</a></li>
    @foreach (var store in ViewBag.Stores)
    {
        <li><a href="#@store.Replace(" ", String.Empty)" data-toggle="tab">@store</a></li>
    }  
</ul>
<div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="all">
        <p>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>
                            Navn
                        </th>
                        <th>
                            Pris
                        </th>
                        <th>
                            Mængde
                        </th>
                        <th>
                            Sidste chance
                        </th>
                        <th>
                            Butik
                        </th>
                    </tr>
                </thead>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.Heading)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Price) kr.
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Unit)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.End)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Store)
                        </td>
                    </tr>
                }

            </table>
        </p>
    </div>
    @foreach (var store in ViewBag.Stores)
    {
        <div class="tab-pane fade" id="@store.Replace(" ", String.Empty)">
            <p>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th class="col-lg-1">I WANT</th>
                            <th class="col-lg-7">
                                Navn
                            </th>
                            <th class="col-lg-1">
                                Pris
                            </th>
                            <th class="col-lg-1">
                                Mængde
                            </th>
                            <th class="col-lg-1">
                                Sidste chance
                            </th>
                        </tr>
                    </thead>
                    @foreach (var item in Model.Where(i => i.Store == @store))
                    {
                        <tr>
                            <td class="col-lg-1">

                                @using (Ajax.BeginForm("AddOfferToShoppingList", new { id = 1, offerID = item.ID }, new AjaxOptions { HttpMethod = "POST", OnSuccess = "processResult" }))
                                {
                                    <button type ="submit" class="btn btn-danger btn-xs">+</button>
                                }
                            </td>
                            <td class="col-lg-7">
                                @Html.DisplayFor(modelItem => item.Heading)
                            </td>
                            <td class ="col-lg-1">
                                @Html.DisplayFor(modelItem => item.Price) kr.
                            </td>
                            <td class="col-lg-1">
                                @Html.DisplayFor(modelItem => item.Unit)
                            </td>
                            <td class="col-lg-1">
                                @Html.DisplayFor(modelItem => item.End)
                            </td>
                        </tr>
                    }

                </table>
            </p>
        </div>
    }
</div>